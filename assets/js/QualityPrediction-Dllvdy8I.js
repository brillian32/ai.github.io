import{E,a as q,b as Q,c as N,i as Z,d as K,e as ee,f as te,C as U}from"./el-table-column-B3GvVvlv.js";import{_ as C,h as R,g as j,q as G,c as i,o as s,j as ae,F as f,r as k,a as n,b as Y,k as oe,t as g,f as M,u as o,n as I,v as se,w as J,p,s as _,x as L,e as ne,y as le}from"./index-C1WhnmXM.js";import{c as A,f as P,d as ie,m as X,p as re,a as W,e as O,g as ce}from"./MapVisualization-BvlVUWBC.js";import{a as de,b as ue,h as pe,w as _e,p as H}from"./ColorScale-Cjf9uyYd.js";import"./aqi_statistics-GnYvFnWA.js";const F={0:{desc:"晴朗",icon:"../../assets/weathers/icon/sunny_icon.png"},1:{desc:"主要晴朗",icon:"../../assets/weathers/icon/sunny_icon.png"},2:{desc:"局部多云",icon:"../../assets/weathers/icon/cloudy_icon.png"},3:{desc:"阴天",icon:"../../assets/weathers/icon/cloudy_icon.png"},45:{desc:"雾",icon:"../../assets/weathers/icon/foggy_icon.png"},48:{desc:"凝霜雾",icon:"../../assets/weathers/icon/foggy_icon.png"},51:{desc:"轻微雨夹雪",icon:"../../assets/weathers/icon/rainy_icon.png"},53:{desc:"中度雨夹雪",icon:"../../assets/weathers/icon/rainy_icon.png"},55:{desc:"浓密雨夹雪",icon:"../../assets/weathers/icon/rainy_icon.png"},56:{desc:"轻微雾凇毛毛雨",icon:"../../assets/weathers/icon/rainy_icon.png"},57:{desc:"强烈雾凇毛毛雨",icon:"../../assets/weathers/icon/rainy_icon.png"},61:{desc:"小雨",icon:"../../assets/weathers/icon/rainy_icon.png"},63:{desc:"中雨",icon:"../../assets/weathers/icon/rainy_icon.png"},65:{desc:"大雨",icon:"../../assets/weathers/icon/rainy_icon.png"},66:{desc:"轻微雨凇",icon:"../../assets/weathers/icon/rainy_icon.png"},67:{desc:"强烈雨凇",icon:"../../assets/weathers/icon/rainy_icon.png"},71:{desc:"轻微雪落",icon:"../../assets/weathers/icon/snowy_icon.png"},73:{desc:"中度雪落",icon:"../../assets/weathers/icon/snowy_icon.png"},75:{desc:"强烈雪落",icon:"../../assets/weathers/icon/snowy_icon.png"},77:{desc:"雪晶",icon:"../../assets/weathers/icon/snowy_icon.png"},80:{desc:"轻微阵雨",icon:"../../assets/weathers/icon/rainy_icon.png"},81:{desc:"中度阵雨",icon:"../../assets/weathers/icon/rainy_icon.png"},82:{desc:"强烈阵雨",icon:"../../assets/weathers/icon/rainy_icon.png"},85:{desc:"小雪",icon:"../../assets/weathers/icon/snowy_icon.png"},86:{desc:"暴雪",icon:"../../assets/weathers/icon/snowy_icon.png"},95:{desc:"雷暴",icon:"../../assets/weathers/icon/thunder_icon.png"},96:{desc:"雷暴伴有轻微的冰雹",icon:"../../assets/weathers/icon/thunder_icon.png"},99:{desc:"雷暴伴有严重的冰雹",icon:"../../assets/weathers/icon/thunder_icon.png"}},he={id:"meteo-table"},ye={class:"label"},fe={class:"unit"},be={key:0,class:"date"},me={key:1,class:"temperature"},ve=["src","onMouseover","onMouseleave"],ge={key:2,class:"wind-dir"},we=["onMouseover","onMouseleave"],xe={__name:"MeteoTable",setup($){const e=A(),S=[{key:"date",label:"",unit:""},{key:"temperature",label:"温度",unit:""},{key:"humidity",label:"湿度",unit:""},{key:"windSpeed",label:"风速",unit:"m/s"},{key:"windDirection",label:"风向",unit:""},{key:"pressure",label:"气压",unit:"hPa"},{key:"precipitation",label:"降水量",unit:"mm"}],c=R(()=>{switch(e.duration){case 1:return 13;case 3:return 8;case 7:return 4;case 14:return 2;default:return 0}}),u=R(()=>{switch(e.duration){case 1:return 4;case 3:return 2;case 7:return 1;case 14:return .5;default:return 0}}),D=(d,l)=>{let r=0;if(l==="pressure"){const y=e.meteoTableData.dataRange[l][0],v=e.meteoTableData.dataRange[l][1];r=v!==y?(d-y)/(v-y)*80+20:d?50:0}else{const y=e.meteoTableData.dataRange[l][1];r=y!==0?d/y*100:0}let h;switch(l){case"humidity":h=pe(d);break;case"windSpeed":h=_e(d);break;case"pressure":h=ue(d);break;case"precipitation":h=de(d);break;default:h=[200,200,200]}return{height:r+"%",backgroundColor:`rgb(${h[0]}, ${h[1]}, ${h[2]})`,margin:`0 ${u.value}px`}},w=j(!0),t=G({visible:!1,content:"",top:0,left:0}),b=(d,l,r)=>{r?(t.visible=!0,t.content=F[m.value[l].weather.toString()].desc,t.top=d.target.offsetTop-25,t.left=d.target.offsetLeft+d.target.clientWidth/2):t.visible=!1},a=G({dayIndex:-1,hourIndex:-1}),x=(d,l,r,h,y)=>{y?(t.visible=!0,t.content=P(m.value[l].hours[r].hour,"HH:mm")+" "+m.value[l].hours[r][h.key]+h.unit,t.top=d.target.offsetTop+d.target.offsetParent.offsetTop-35,t.left=d.target.offsetLeft+d.target.offsetParent.offsetLeft+d.target.clientWidth/2,a.dayIndex=l,a.hourIndex=r):(t.visible=!1,t.content="",a.dayIndex=-1,a.hourIndex=-1)},m=R(()=>e.meteoTableData.tableData),B=d=>new URL(d,import.meta.url).href;return(d,l)=>(s(),i("div",he,[(s(),i(f,null,k(S,r=>n("div",{key:r.key,class:I(["row",{date:r.key==="date",temperature:r.key==="temperature","wind-dir":r.key==="windDirection"}])},[n("div",ye,[Y(g(r.label)+" ",1),r.unit.length?(s(),i(f,{key:0},[l[0]||(l[0]=n("br",null,null,-1)),n("div",fe,"("+g(r.unit)+")",1)],64)):oe("",!0)]),(s(!0),i(f,null,k(m.value,(h,y)=>(s(),i("div",{key:y,class:"days",style:M({width:o(e).duration===1?h.hours.length/24*100+"%":"100%",padding:`0 ${c.value}px`})},[r.key==="date"?(s(),i("div",be,g(o(P)(h.date,"yyyy-MM-dd week")),1)):r.key==="temperature"?(s(),i("div",me,[n("img",{src:B(o(F)[h.weather.toString()].icon),onMouseover:v=>b(v,y,!0),onMouseleave:v=>b(v,y,!1)},null,40,ve),n("p",null,g(h.tempRange[0])+"~"+g(h.tempRange[1])+"℃",1)])):r.key==="windDirection"?(s(),i("div",ge,[(s(!0),i(f,null,k(h.hours.filter((v,T)=>{if(o(e).duration===1||o(e).duration===3)return!0;if(o(e).duration===7)return T%3===2;if(o(e).duration===14)return T%6===3}),v=>(s(),i("div",{key:v.hour,class:"direction",style:M({transform:`rotate(${v.windDirection}deg)`})},null,4))),128))])):(s(),i("div",{key:3,class:I(["bar-container",{animate:w.value}])},[(s(!0),i(f,null,k(h.hours,(v,T)=>(s(),i("div",{key:v.hour,class:I(["bar",{hovered:y===a.dayIndex&&T===a.hourIndex}]),style:M(D(v[r.key],r.key)),onMouseover:V=>x(V,y,T,r,!0),onMouseleave:V=>x(V,y,T,r,!1)},null,46,we))),128))],2))],4))),128))],2)),64)),ae(n("div",{class:"tooltip",style:M({top:t.top+"px",left:t.left+"px"})},g(t.content),5),[[se,t.visible]])]))}},ke=C(xe,[["__scopeId","data-v-75351f56"]]),Se={id:"toolbar"},De={class:"wrapper"},$e={class:"wrapper"},Le={style:{"font-size":"14px"}},Te={__name:"ToolbarA",setup($){const e=A(),S=[{label:"贵阳市",value:"guiyang"},{label:"六盘水市",value:"liupanshui"},{label:"遵义市",value:"zunyi"},{label:"安顺市",value:"anshun"},{label:"毕节市",value:"bijie"},{label:"铜仁市",value:"tongren"},{label:"兴义市",value:"xingyi"},{label:"都匀市",value:"duyun"},{label:"凯里市",value:"kaili"}];return J(()=>[e.dateListIndex,e.dateList],()=>{console.log("dateListIndex A : ",e.dateListIndex),console.log("chart data : ",e.chartData)}),(c,u)=>{const D=E,w=q,t=Q,b=N;return s(),i("div",Se,[n("div",De,[p(w,{modelValue:o(e).city,"onUpdate:modelValue":u[0]||(u[0]=a=>o(e).city=a),placeholder:"Select",style:{width:"200px"},class:"highlight left"},{default:_(()=>[(s(),i(f,null,k(S,a=>p(D,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),p(b,{modelValue:o(e).duration,"onUpdate:modelValue":u[1]||(u[1]=a=>o(e).duration=a),class:"left"},{default:_(()=>[(s(!0),i(f,null,k(o(ie),a=>(s(),L(t,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",$e,[p(w,{modelValue:o(e).dateListIndex,"onUpdate:modelValue":u[2]||(u[2]=a=>o(e).dateListIndex=a),placeholder:"算法更新时间",style:{width:"285px"},class:"highlight left"},{label:_(({label:a})=>[u[3]||(u[3]=n("span",null,"算法更新时间",-1)),n("span",Le,g(a),1)]),default:_(()=>[(s(!0),i(f,null,k(o(e).listLabels,(a,x)=>(s(),L(D,{key:x,label:a,value:x},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])}}},Ce=C(Te,[["__scopeId","data-v-9f903d49"]]),Me={class:"toolbox-wrapper"},z="M 0 0 A 1 1 0 0 0 6 0 A 1 1 0 0 0 0 0 M -3 0.5 L 9 0.5 L 9 -0.5 L -3 -0.5 L -3 0.5",Be={__name:"PollutionChart",setup($){const e=A(),S=j(null);let c=null;const u=["#33DAAB","#35BEF0"],D=()=>{S.value&&(c=Z(S.value,null,{renderer:"canvas",useDirtyRect:!1}),t(),window.addEventListener("resize",w))},w=()=>{c?.resize()};ne(()=>{D()}),le(()=>{window.removeEventListener("resize",w),c?.dispose()}),J(()=>[e.chartData],()=>{t()},{deep:!0});const t=()=>{const b={grid:{top:40,right:34,bottom:60,left:54},xAxis:{type:"category",data:e.chartData.xAxisData,boundaryGap:!1,axisLine:{lineStyle:{color:"#8D9293",opacity:.5}},axisLabel:{margin:14,fontFamily:"HarmonyOS Sans SC",fontSize:12,color:"#909192",interval:(a,x)=>e.duration===3||e.duration===7?a%6===0:!0},axisTick:{show:!1},splitLine:{show:!0,alignWithLabel:!0,lineStyle:{color:"#000000",type:"dashed",dashOffset:[4,4],opacity:.1}}},yAxis:[{type:"value",name:e.chartData.pollutant1,nameGap:0,alignTicks:!0,nameTextStyle:{padding:[0,0,-20,50],fontFamily:"HarmonyOS Sans SC",fontSize:16,color:"#909192"},axisLine:{show:!0,symbol:["none","arrow"],symbolSize:[8,8],lineStyle:{color:"#8D9293",opacity:.5}},axisLabel:{showMaxLabel:!1,fontSize:12,color:"#909192"},splitLine:{show:!0,showMaxLine:!1,lineStyle:{color:"#000000",type:"dashed",dashOffset:[4,4],opacity:.1}}},{type:"value",name:`${e.chartData.pollutant2}
(${W[e.chartData.pollutant2]})`,nameGap:0,alignTicks:!0,nameTextStyle:{padding:[0,0,-20,-80],align:"center",verticalAlign:"top",fontFamily:"HarmonyOS Sans SC",fontSize:16,lineHeight:20,color:"#909192"},axisLine:{show:!0,symbol:["none","arrow"],symbolSize:[8,8],lineStyle:{color:"#8D9293",opacity:.5}},axisLabel:{showMaxLabel:!1},splitLine:{show:!0,showMaxLine:!1,lineStyle:{color:"#000000",type:"dashed",dashOffset:[4,4],opacity:.1}}}],series:[{name:e.chartData.pollutant1,type:"line",yAxisIndex:0,data:e.chartData.data1,symbol:"circle",symbolSize:8,showSymbol:!1,smooth:!0,itemStyle:{color:u[0],borderColor:"#fff",borderWidth:2,shadowColor:"#fff",shadowBlur:0},emphasis:{scale:1.3,itemStyle:{color:"#fff",borderColor:u[0],borderWidth:4,shadowColor:"rgba(0, 0, 0, 0.25)",shadowBlur:3}}},{name:e.chartData.pollutant2,type:"line",yAxisIndex:1,data:e.chartData.data2,symbol:"circle",symbolSize:8,showSymbol:!1,smooth:!0,itemStyle:{color:u[1],borderColor:"#fff",borderWidth:2,shadowColor:"#fff",shadowBlur:0},emphasis:{scale:1.3,itemStyle:{color:"#fff",borderColor:u[1],borderWidth:4,shadowColor:"rgba(0, 0, 0, 0.25)",shadowBlur:3}}}],legend:{data:[{name:e.chartData.pollutant1,icon:"path://"+z},{name:e.chartData.pollutant2,icon:"path://"+z}],y:"bottom",itemGap:24,itemStyle:{borderColor:"none",borderWidth:0},textStyle:{padding:6,fontFamily:"HarmonyOS Sans SC",fontSize:14,color:"#4E4E4F"}},tooltip:{trigger:"axis",axisPointer:{z:1,lineStyle:{color:"#75B6BE",type:"solid"}},formatter:function(a){let x=`<div class='tooltip' style='width: 170px'><div class='header'> ${a[0].name} </div>`;for(var m=0;m<2;m++)x+=`<div class='wrapper'><div class='name'> ${a[m].seriesName} </div><div class='svg-container'><svg viewBox='-3 -3 12 6' preserveAspectRatio='xMidYMid meet'> <path d='${z}' fill='${a[m].color}'/></svg></div><div class='value'> ${a[m].value} <span class='unit'> ${W[a[m].seriesName]}</span></div></div>`;return x+="</div>",x},extraCssText:"padding: 0; border-radius: 4px; box-shadow: 4px 4px 8px rgba(125.01, 158.98, 163.41, 0.50);"}};c.setOption(b)};return(b,a)=>{const x=E,m=q,B=Q,d=N;return s(),i(f,null,[n("div",Me,[p(m,{modelValue:o(e).model,"onUpdate:modelValue":a[0]||(a[0]=l=>o(e).model=l),placeholder:"Select",style:{width:"160px"},class:"left"},{default:_(()=>[(s(!0),i(f,null,k(o(X),l=>(s(),L(x,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),p(d,{style:{"margin-right":"6px"}},{default:_(()=>[p(B,{label:"AQI",value:"AQI",disabled:""})]),_:1}),p(d,{modelValue:o(e).pollutant,"onUpdate:modelValue":a[1]||(a[1]=l=>o(e).pollutant=l)},{default:_(()=>[(s(!0),i(f,null,k(o(re).filter(l=>l!=="AQI"),l=>(s(),L(B,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",{id:"chart-container",ref_key:"container",ref:S},null,512)],64)}}},Ae=C(Be,[["__scopeId","data-v-0d065fa9"]]),Ve={id:"toolbar"},Re={class:"wrapper"},Ie={class:"wrapper"},ze={style:{"font-size":"14px"}},Pe={__name:"ToolbarB",setup($){const e=O();return(S,c)=>{const u=E,D=q,w=K;return s(),i("div",Ve,[n("div",Re,[p(D,{modelValue:o(e).curModel,"onUpdate:modelValue":c[0]||(c[0]=t=>o(e).curModel=t),placeholder:"Select",style:{width:"160px"},class:"left"},{default:_(()=>[(s(!0),i(f,null,k(o(X),t=>(s(),L(u,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),n("div",Ie,[p(D,{modelValue:o(e).dateListIndex,"onUpdate:modelValue":c[1]||(c[1]=t=>o(e).dateListIndex=t),placeholder:"算法更新时间",style:{width:"285px"},class:"highlight left"},{label:_(({label:t})=>[c[2]||(c[2]=n("span",null,"算法更新时间",-1)),n("span",ze,g(t),1)]),default:_(()=>[(s(!0),i(f,null,k(o(e).listLabels,(t,b)=>(s(),L(u,{key:b,label:t,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),p(w,{style:{width:"90px",height:"40px"},class:"right",onClick:o(e).exportExcel},{default:_(()=>c[3]||(c[3]=[n("i",{class:"export-icon"},null,-1),Y("导出 ")])),_:1},8,["onClick"])])])}}},Ee=C(Pe,[["__scopeId","data-v-2d34dd63"]]),qe={class:"horizontal-item"},Oe={class:"agi-range"},Ue={class:"value-label"},Ge={class:"pollutant-label"},We={__name:"AqiRange",props:{aqiRange:{type:Object,default:()=>({min:0,max:0})},pollutant:{type:String,default:"PM2.5"}},setup($){const e=$;return(S,c)=>(s(),i("div",qe,[n("div",Oe,[n("div",{class:"color-block",style:M({background:`linear-gradient(
          ${o(H)("AQI",e.aqiRange.min).background} ,
          ${o(H)("AQI",e.aqiRange.max).background})`})},null,4),n("div",Ue,g(e.aqiRange.min)+" - "+g(e.aqiRange.max),1)]),n("div",Ge,g(e.pollutant),1)]))}},He=C(We,[["__scopeId","data-v-9de7c4bc"]]),Fe={id:"pollution-table"},Qe={class:"name"},Ne={class:"date"},je={__name:"PollutionTable",setup($){const e=O();return(S,c)=>{const u=ee,D=te;return s(),i("div",Fe,[p(D,{data:o(e).tableData.tableData},{default:_(()=>[p(u,{prop:"city","class-name":"city-header",width:"100px"},{header:_(()=>c[0]||(c[0]=[n("div",{class:"title"},"监测点",-1)])),default:_(w=>[n("div",Qe,g(o(ce)[w.row.city]),1)]),_:1}),(s(!0),i(f,null,k(o(e).tableData.tableData?.[0]?.aqi,(w,t)=>(s(),L(u,{key:t,prop:"primaryPollutant","class-name":"date-header"},{header:_(()=>[n("div",Ne,g(o(P)(o(e).tableData.tableDate[t],"yyyy-MM-dd week")),1),c[1]||(c[1]=n("div",{class:"wrapper"},[n("div",{class:"head1"},"AQI"),n("div",{class:"head2"},"首要污染物")],-1))]),default:_(b=>[n("div",null,[p(He,{"aqi-range":b.row.aqi[t],pollutant:o(e).tableData.tableData[b.$index].primaryPollutant[t]},null,8,["aqi-range","pollutant"])])]),_:2},1024))),128))]),_:1},8,["data"])])}}},Ye=C(je,[["__scopeId","data-v-ab3cd53e"]]),Je={id:"quality-prediction"},at={__name:"QualityPrediction",setup($){return A().fetchChartData(),O().fetchTableData(),(c,u)=>(s(),i("div",Je,[p(U,{id:"analysis",title:"城市级空气指标预报"},{header:_(()=>[p(Ce)]),content:_(()=>[p(ke),p(Ae)]),_:1}),p(U,{id:"prediction",title:"贵州省近7天AQI及首要污染物预测"},{header:_(()=>[p(Ee)]),content:_(()=>[p(Ye)]),_:1})]))}};export{at as default};
